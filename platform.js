(function(g){function a(b,f){return b(i,function(){return n[b.name]=f})}function o(){n={}}function h(b){return typeof b=="object"&&b||[b]}function r(b){return/^[A-Z]/.test(b)}function p(b,f,q){g.each(f,function(k,d){g.each(q,function(){b&&l.unbind(d,this);l[b&&"bind"||"unbind"](d,this)})})}function s(b,f){t.debug&&console.log(b.length==1&&b[0]||b,f||"");g.each(b,function(q,k){r(k)&&console.log("USER EVENT");l.trigger(k,f)})}platform=function(b){return b&&a.apply(i,arguments)||i};var t={debug:true},
i={version:"0.1.1",hello:function(){return"Hello"},kick:function(b,f){s(h(b),f)},on:function(b,f){p(true,h(b),h(f))},un:function(b,f){p(false,h(b),h(f))},reboot:function(){return i.kick("Reboot")}},n,l=g(document);i.on("Reboot",o);o()})(jQuery);
(function(g){platform(function(a,o){function h(){d=o()}function r(e,c){if(!d.methods){d.methods=c;g.each(c.split(" "),function(j,m){u[m]=[];a[m]=function(v,w){a.kick("routeDefined",[m,v,w])}})}}function p(e,c){c=c&&c||"GET";if(!(c&&d.methods.indexOf(c)>-1))return a.kick("invalidMethod",c);a.kick("validMethod",c)}function s(e,c){d.method=c;a.kick("newMethod")}function t(){a.kick("noCookie")}function i(e,c){d.cookie=c;a.kick("newCookie")}function n(e,c,j){if(!/\/.*/.test(j))return a.kick("invalidQuery");
a.kick("validQuery",j)}function l(e,c){d.query=c;a.kick("newQuery")}function b(){a.kick("STATUS",400)}function f(e,c,j,m){u[c].push({name:j.toString(),route:j,callback:m})}function q(){g.each(u[d.method],function(e,c){e=d.query.substr(1);e=c.route.test(e);d.route=!d.route&&e&&c;d.route&&c.callback.apply(a)});if(d.route)return a.kick("validRoute");a.kick("noRoute")}function k(){a.kick("http_GET")}g.extend(a,{request:function(e,c){a.kick("Request",[c,e])},methods:function(e){a.kick("methodsAllowed",
e)}});var d,u={};a.on("Reboot",h);a.on("methodsAllowed",r);a.on("routeDefined",f);a.on("Request",[p,t,n]);a.on("validMethod",s);a.on("validCookie",i);a.on("validQuery",l);a.on("invalidQuery",b);a.on("newQuery",[q,k]);h()},{method:"",methods:"",cookies:{},query:"",route:undefined})})(jQuery);
